<!DOCTYPE html>
<html>
<head>
<!-- 부트스트랩 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<!-- 구글폰트 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poiret+One&display=swap" rel="stylesheet">
<!-- CSS 파일 -->
<link rel="stylesheet" href="../css/banner1.css">
<link rel="stylesheet" href="../css/shop.css">
<meta charset="UTF-8">
<title>SMOA ORDER</title>

<style>
.btn-dark {
    color: #fff;
    background-color: #424242;
    border-color: #212529;
}

.spinner-grow {
	position: absolute;
	margin: 50% 50% 50% 50%;
}

</style>
<div class="spinner-grow text-secondary" id="roading" role="status" style="display:none;">
  <span class="visually-hidden">Loading...</span>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script type="text/javascript">
let title = "";
let price = 0;
let info = "";
let img = "";
window.onload = () => {
	title = localStorage.getItem("title");
	price = localStorage.getItem("price");
	/* info = localStorage.getItem("info"); */
	img = localStorage.getItem("img");	
	let title2 = document.getElementById("title2");
	title2.innerHTML = title;
	let titleDom = document.getElementById("title");
	titleDom.innerHTML = title;
	let priceDom = document.getElementById("price");
	priceDom.innerHTML = Number(price).toLocaleString();
	/* let infoDom = document.getElementById("info");
	infoDom.innerHTML = info; */
	document.img.src = img;
}
const a = () => {
	let priceDom = document.getElementById("price");
	let txt = priceDom.innerHTML;//txt => 가격:29000
	let arr = txt.split(":");
	let price = parseInt(arr[1]);
	//alert("price:"+price);
	let amount = parseInt(f.amount.value);
	let res = price*amount;
	let resSpan = document.getElementById("res");
	resSpan.innerHTML = res;
}

const b = () => {
	//주문페이지에 담기는 정보
	let amount = parseInt(f.amount.value);
	let res = price*amount;
	let resSpan = document.getElementById("res");
	resSpan.innerHTML = Number(res).toLocaleString()+"원";
	
	//장바구니 모달에 담기는 정보
	let total = document.getElementById("amt");
	total.innerHTML = amount;
	let each = document.getElementById("each");
	each.innerHTML = Number(price).toLocaleString();
	
	let result = document.getElementById("result");
	result.innerHTML = Number(price*amount).toLocaleString();
}


function pay() {
	let amount = parseInt(f.amount.value);
	let con = document.getElementById("roading");
	if(amount == 0) {
		alert("수량을 1개 이상 선택해주세요.")
	}
	else {
		con.style.display = 'flex';
		alert(title + " 주문을 완료하려면 확인을 눌러주세요.");
		alert("결제가 완료되었습니다.");
		setTimeout("location.href='shop.html'", 400);
	}	
}

function add() {
	let amount = parseInt(f.amount.value);
	let con = document.getElementById("roading");
	if(amount == 0) {
		alert("수량을 1개 이상 선택해주세요.")
		setTimeout("location.href='order.html'", 300);
	} else {
		alert(title + "이 장바구니에 담겼습니다.")	
		con.style.display = 'flex';
		setTimeout("location.href='shop.html'", 400);
	}
}
</script>

</head>
<body>
	<div class="banner" onclick="location.href='movie2.html'">
		<b>SONG'S <br /> MUSEUM OF <br /> ART
		</b>
	</div>
	<nav id="bread" style="--bs-breadcrumb-divider: '';" aria-label="breadcrumb">
	  <ol class="breadcrumb justify-content-center">
	    <li class="breadcrumb-item"><a href="#" onclick="location.href='program.html'">PROGRAM</a></li>
	    <li class="breadcrumb-item active" aria-current="page">MUSEUM SHOP</li>
	    <li class="breadcrumb-item"><a href="#" onclick="location.href='info.html'">INFOMATION</a></li>
	    <li class="breadcrumb-item"><a href="#" onclick="location.href='reserve.html'">TICKET RESERVATION</a></li>
	  </ol>
	</nav>
	
	<!-- item shop 누르면 -->
		
	<form name="f">
		<table>
			<tr>
				<td rowspan="3"><img
					style="width: 240px; height: 240px; border-radius: 10px;" src=""
					name="img"></td>
				<td style="text-align:left; font-size:17px">가격: <span id="price"></span>원 </td>
			<tr>
				<td style="text-align:left; font-size:17px">수량: <select id="sel-value" name="amount" onchange="b()" style="cursor:pointer">
						<option value="0">0</option>
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5</option>
				</select>
				</td>
			</tr>
			<tr>
				<td style="text-align:left; font-size:17px">결제금액:  <span id="res"></span><br/>
					<div class="d-grid gap-2 d-md-flex justify-content-md-left" style="margin-top:40px;">
					  <button class="orderbutton btn btn-dark btn-sm me-md-2" type="button" value="즉시결제" onclick="pay()">즉시결제</button>
					  <button class="btn btn-dark btn-sm" type="button" value="장바구니" data-bs-toggle="modal" data-bs-target="#exampleModal">장바구니</button>
						<!-- Modal -->
						<div class="modal fade" id="exampleModal" tabindex="-1"
							aria-labelledby="exampleModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content" style="background-color: #242424">
									<div class="modal-header">
										<h5 class="modal-title" id="exampleModalLabel" style="font-weight:lighter">장바구니에 담기</h5>
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										상품명: <span style="font-weight:lighter; font-size:18px" id="title"></span><br/>
										배송비: <span style="font-weight:lighter; font-size:18px"> 3,000원[조건]/기본배송</span><br/>
										가격: <span style="font-weight:lighter; font-size:18px" id="each"></span>원/개 당<br/>
										수량: <span style="font-weight:lighter; font-size:18px" id="amt"></span>개<br/><br/>
										합계: <span style="font-weight:lighter; font-size:18px" id="result"></span>원<br/>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">취소</button>
										<button type="button" class="btn btn-secondary" onclick="add()">담기</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</td>
			</tr>
			<tr>
				<th colspan="1"><span style="font-weight:lighter; font-size:20px; color:#f2f2f2" id="title2"></span></th>
			</tr>
		</table>
	</form>
</body>
</html>